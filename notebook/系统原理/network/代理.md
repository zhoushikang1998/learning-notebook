## OSI 七层模型和 TCP/IP 四层模型

- TCP/IP 模型中，物理层和数据链路层合并成**网络接口层**。

  ![img](images\网络模型.jpg)



## 四层/七层反向代理

- 四层代理：**传输层(TCP)代理**。根据用户 ip+port 来做代理

  - 实现四层负载均衡的方式：

    ```properties
    F5: 硬件负载均衡器，功能很好，但成本很高
    LVS: 重量级的四层负载软件
    Nginx: 轻量级的四层负载软件，带缓存功能，正则表达式较灵活
    HAProxy: 模拟四层转发，较灵活
    ```

- 七层代理：**应用层(HTTP)代理**。根据 http 协议中的默写属性来做代理

  - 实现七层负载均衡的方式：

    ```properties
    HaProxy: 天生负载均衡技能，全面支持七层代理，会话保持、标记、路径转移。
    Nginx: 只在 http 协议和 mail 协议上功能比较好，性能和 HaProxy 差不多
    apache: 功能较差
    MySQL proxy: 功能尚可。
    ```

    

- 二层代理：根据数据链路层 MAC 地址完成数据交换

  - 交换机在**第二层（数据链路层）**进行数据转发

- 三层代理：根据网络层 IP 地址完成数据交换。

  - 路由器在**第三层（网络层）**进行数据转发
  - 一般采用虚拟 IP 地址（VIP）方式，外部对虚拟的 ip 地址请求，负载均衡接收后分配后端实际的 IP 地址响应。