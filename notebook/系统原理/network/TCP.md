## TCP三次握手

### 过程

- A（客户端） 主动打开连接，B（服务器） 被动打开连接。
- 一开始，B 的TCP 服务器进程处于 LISTEN（收听）状态，等待客户的连接请求。
- 第一次握手：**A 在打算建立 TCP 连接时，向 B 发出连接请求报文段**，首部中的 同步位 SYN = 1。SYN 报文段（即SYN = 1的报文段）不能携带数据。TCP 客户进程进入 SYN-SENT（同步已发送）的状态。
- 第二次握手：**B 收到连接请求报文段后，如同意建立连接，则向 A 发送确认。**在确认报文段中应把 SYN 位和 ACK 位都置1。这个报文段也不能携带数据。这时 TCP 服务器进程进入 SYN-RCVD（同步收到）状态。
- 第三次握手：**TCP 客户进程收到 B 的确认后，还要向 B 给出确认。**确认报文段的 ACK 置 1，ACK 报文段可以携带数据。这时，TCP连接已经建立，A 进入 ESTABLISHED（已建立连接）状态。
- 当 B 收到 A 的确认后，也进入 ESTABLISHED 状态。

### 问题&&细节

- 为什么 A 最后还要发送一次确认呢？

这主要是为了防止**已失效的连接请求报文段**突然又传送到了 B，因而产生错误。